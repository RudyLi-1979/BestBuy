version: '3.8'

services:
  ucp-server:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: bestbuy-ucp-server
    ports:
      - "58000:58000"
    environment:
      # Load environment variables from .env file
      - BESTBUY_API_KEY=${BESTBUY_API_KEY}
      - GEMINI_API_KEY=${GEMINI_API_KEY}
      - GEMINI_API_URL=${GEMINI_API_URL}
      - DATABASE_URL=${DATABASE_URL:-sqlite:///./ucp_bestbuy.db}
    volumes:
      # Mount local code for real-time updates during development (can be removed in production)
      - .:/app
      # Persist database
      - ./ucp_bestbuy.db:/app/ucp_bestbuy.db
      # Persist keys directory
      - ./keys:/app/keys
    env_file:
      - .env
    restart: unless-stopped
    networks:
      - ucp-network

networks:
  ucp-network:
    driver: bridge
